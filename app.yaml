application: gift-starter
version: 57
runtime: python27
api_version: 1
threadsafe: yes

handlers:

# Dynamic Sitemaps
- url: /sitemap-giftideas.xml
  script: sitemap.sitemap_api.handler
  secure: always

# Product
- url: /products/urls/.*.json
  script: product.product_api.handler
- url: /products/.*.json
  script: product.product_api.handler
- url: /product
  script: product.product_api.handler

# GiftStart
- url: /giftstart/api # MAKE RESTful!... Remove?
  script: giftstart.giftstart_api.api
- url: /giftstart/api/hot-campaigns # MAKE RESTful!
  script: giftstart.giftstart_api.hot_campaigns
- url: /create-giftstart # MAKE RESTful!
  script: main.app
  secure: always
- url: /giftstart/share
  script: share.email_share_handler
- url: /giftstart/.*/card
  script: giftstart.giftstart_card.handler
  login: admin
- url: /giftstart/.*.json
  script: giftstart.giftstart_api.handler
  secure: always
- url: /giftstarts.json
  script: giftstart.giftstart_api.handler
  secure: always
- url: /giftstart/.*
  script: main.app
  secure: always

# Pay
- url: /pay
  script: pay.pay_api.api

# Thank
- url: /thanks.*
  script: thank.thank_api.handler

# Users
- url: /users.*
  script: gs_user.gs_user_api.api
- url: /reports
  script: reports.handler
  login: admin

# Login
- url: /login/.*
  script: login.login_api.handler
  secure: always

# Email
- url: /email/.*
  script: gs_email.gs_email_api.handler

# Feeds
- url: /feeds/.*
  script: feeds.feeds_api.handler

# Analytics
- url: /a/.*
  script: analytics.handler
  secure: always

# Client static asset urls
- url: /favicon\.ico
  static_files: client/assets/favicon.ico
  upload: client/assets/favicon\.ico
  secure: always
- url: /stylesheets
  static_dir: client/stylesheets
  secure: always
- url: /scripts/utilities/link_create.html
  static_files: client/scripts/utilities/link_create.html
  upload: link_create.html
  secure: never
- url: /scripts
  static_dir: client/scripts
  secure: always
- url: /bower_components
  static_dir: client/bower_components
  secure: always
- url: /assets
  static_dir: client/assets
  application_readable: true
  secure: always
- url: /assets/giftideas/category/forhim/
  static_dir: client/assets/giftideas/category/forHim/
  secure: always
- url: /pet-lovers/
  static_dir: client/assets/giftideas/category/pet-lovers/
  application_readable: true
  secure: always
- url: /sympathy/
  static_dir: client/assets/giftideas/category/sympathy/
  application_readable: true
  secure: always
- url: /templates/angular
  static_dir: client/templates/angular
  secure: always
- url: /robots.txt
  static_files: robots.txt
  upload: robots.txt
- url: /sitemap.xml
  static_files: sitemap.xml
  upload: sitemap.xml
- url: /sitemap-app.xml
  static_files: sitemap-app.xml
  upload: sitemap-app.xml
- url: /googled6c05fd809b457a4.html
  static_files: googled6c05fd809b457a4.html
  upload: googled6c05fd809b457a4.html

# Data dumps
- url: /dump/.*
  script: analytics.handler
  login: admin

# Blog
- url: /blog
  script: blog.handler
  secure: always
- url: /blog/.*
  script: blog.handler
  secure: always
- url: /press
  script: blog.handler
  secure: always
- url: /press/
  script: blog.handler
  secure: always
- url: /wedding.*
  script: blog.handler
  secure: always

# Catch all other urls
- url: /admin.*
  script: google.appengine.ext.admin.application
  login: admin
- url: /.*
  script: main.app
  secure: always

# GiftStarter v2
## if this gets re-enabled, comment out skip_files: - client/bower_components/*
#- url: /neu/js #scripts
#  static_dir: client/v2/js/
#  secure: always
#  login: admin
#- url: /neu/css/all\.css #stylesheets
#  static_files: client/v2/css/all.css
#  upload: client/v2/css/all\.css
#  secure: always
#  login: admin
#- url: /neu/(.*)\.ng\.html #all ng.html files
#  static_files: client/v2/\1.ng.html
#  upload: client/v2/.*\.ng\.html
#  secure: always
#  login: admin
#- url: /neu(/)* #homepage
#  static_files: client/v2/index.html
#  upload: client/v2/index\.html
#  secure: always
#  login: admin
#- url: /neu/(.*) #catchall
#  static_files: client/v2/404.html
#  upload: client/v2/404\.html
#  secure: always
#  login: admin

builtins:
  - admin_redirect: on
  - appstats: on

libraries:
- name: webapp2
  version: "latest"
- name: jinja2
  version: "latest"
- name: lxml
  version: "2.3"
- name: ssl
  version: latest

env_variables:
  OAUTHLIB_INSECURE_TRANSPORT: 1

skip_files:
- grunt/.*
- ^(.*/)?#.*#$
- ^(.*/)?.*~$
- ^(.*/)?.*\.py[co]$
- ^(.*/)?.*/RCS/.*$
- ^(.*/)?\..*$
- client/stylesheets/^(?!compiled)
- client/test/*
- client/bower_components/*
- client/scripts/^(?!out)
