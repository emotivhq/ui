<div class="giftstart wrapper" ng-controller="GiftStartController" ng-mousemove="mouseActivityCallback('mouse-move')" ng-click="mouseActivityCallback('click')">

    <div class="fullwidth block">
        <div class="title">
            <h1 class="title" ng-hide="editMode">{{giftStart.title}}</h1><input class="title" ng-model="newTitle" ng-show="editMode"/><span class="title edit"></span>
        </div>
    </div>

    <div class="fullwidth block">

        <div class="col2 block">
            <a ng-href="{{giftStart.product_url}}" rel="nofollow" class="title" target="_blank" ng-click="productLinkClicked();" ng-mouseover="hideOverlay();" ng-mouseleave="showOverlay();" ng-show="giftStart.product_title">{{giftStart.product_title}}</a>

            <div class="description">
                <span class="description edit"><textarea class="description" ng-model="newDescription" ng-show="editMode"></textarea></span>
                <span class="description makelinks" ng-hide="editMode" style="white-space: pre-line;">{{giftStart.description}}</span>
            </div>
            <div class="signature">
                <p class="name" ng-show="!editMode"><span ng-show="giftStart.gc_name.length > 0">&mdash; </span>{{giftStart.gc_name}}</p><input class="gc-name" ng-model="newGcName" ng-show="editMode"/>
                <button class="edit" ng-show="campaignEditable && !editMode && secondsLeft > 0 && !campaignComplete()" ng-click="editMode=true;">EDIT</button>
                <div class="save"><button class="save" ng-click="updateCampaign();" ng-show="editMode">Save</button><button class="save" ng-click="editMode=false;" ng-show="editMode">X</button></div>
                <p ng-show="giftStart.gc_name.length > 0 || editMode" class="gift-champion">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gift Champion</p>
            </div>
        </div>
        <div class="overlay block">
                <div class="image-upload" ng-show="editMode"><label>Upload New Image:  </label><input id="campaign-image-input" type="file" capture="camera" accept="image/*"/></div>
            <gs-overlay ng-class="{initialized: pitchInsInitialized}" giftstart="giftStart" ng-click="selectionUpdated();"></gs-overlay>
        </div>
        <div class="col2 block">
            <div class="pitch-instructions">
                <p ng-show="secondsLeft > 0 && !campaignComplete()"><span class="ordinal">1.</span> Click on the tiles you want to purchase</p>
                <p ng-show="secondsLeft > 0 && !campaignComplete()"><span class="ordinal">2.</span> Pitch in!</p>
            </div>
            <button class="pitch-in button" ng-show="secondsLeft > 0 && !campaignComplete()" ng-class="{disabled: giftStart.totalSelection == 0}" ng-click="pitchIn()" ng-mouseover="pitchInHoverCallback()" title="{{pitchinButtonHoverMessage}}">Pay ${{giftStart.totalSelection / 100 | number : 2}} Now</button>
            <div class="giftstart-this" ng-show="secondsLeft <= 0 || campaignComplete()">
                Would you like to give this gift to someone you know?  Click the button below to start your own campaign for this gift.<br/>
                <a class="giftstart-this-link" target="_self" href="{{giftstartThisUrl()}}"><button class="pitch-in button">GiftStart It</button></a>
            </div>
            <div class="invite block">
                <h3 class="black invite-friends">Share This Campaign With Friends!</h3>
                <img class="share" src="/assets/share_email.png" ng-click="emailShare();" />
                <img class="share" src="/assets/share_facebook.png" ng-click="facebookShare();"/>
                <img class="share" src="/assets/share_twitter.png" ng-click="twitterShare();" />
                <img class="share" src="/assets/share_google.png" ng-click="googlePlusShare();" />
            </div>
        </div>
    </div>

    <div class="fullwidth block">
        <div class="prices block">
            <div class="price funded">
                <h2>Gifted!</h2>
                <h1>$<span class="giftstart product contribution">{{giftStart.funded / 100 | number : 2}}</span></h1>
            </div>
            <div class="price remaining">
                <h2>Amount Needed</h2>
                <h1>$<span class="giftstart product remaining">{{giftStart.remaining / 100 | number : 2}}</span></h1>
            </div>
            <gs-funding-bar></gs-funding-bar>
        </div>
        <div class="completion block">
            <div><h2>Time Left in GiftStart</h2></div>
            <div><h1 class="countdown" ng-class="{danger: (secondsLeft < 86400) && (secondsLeft <= 0)}">{{countdown}}</h1></div>
        </div>
    </div>

    <gs-thanks></gs-thanks>

    <div class="groupcard">
        <div class="title title--groupcard">
            <h3 class="title__name">Group Card</h3>
            <span class="title__catchline">To sign the card, first pitch-in by purchasing some tiles above</span>
        </div>
        <div ng-repeat-start="pitchIn in pitchIns" ng-class="{true: 'contributors--row'}[$index % 3 == 0 && !$first]" class="h--hide"></div>
        <div class="contributors" ng-class="{true: 'contributors--only'}[pitchIns.length == 1]">
            <div class="contributors__figure">
                <a class="contributors__link" ng-href="/users/{{pitchIn.uid}}">
                    <img class="contributors__img" ng-src="{{pitchIn.img}}" />
                </a>
            </div>
            <div class="contributors__info">
                <h3 class="contributors__name">{{pitchIn.name}}</h3>
                <p class="contributors__info">{{pitchIn.note}}</p>
            </div>
        </div>
        <div ng-repeat-end class="h--hide"></div>
        <p class="nocontributors" ng-hide="pitchIns.length > 0">No contributors yet - be the first one on the card!</p>
    </div>
</div>
