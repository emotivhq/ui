<div class="giftstart wrapper ui container main pad" ng-controller="GiftStartController">
    <div class="ui container aligned center centered teal" ng-class="{segment: editMode}">
        <div class="ui form">
            <h2 class="title campaign-title ui center aligned icon header bottom medium vertical" ng-hide="editMode">
				<i class="gift icon teal"></i> {{giftStart.title}}
			</h2>
            <div class="ui huge left icon input fluid" ng-show="editMode">
                <input class="title" ng-model="newTitle" style="text-align: center;" />
                <i class="quote left icon"></i>
            </div>
            <span class="title edit"></span>
        </div>
    </div>

    <div class="ui container column grid">
        <div class="gs-overlay ui eight wide computer sixteen wide mobile column" Xng-class="{shrunk: showPayBox}">
            <div class="image-upload ui form segment teal" ng-show="editMode">
                <label>Upload New Image:</label>
                <input id="campaign-image-input" type="file" capture="camera" accept="image/*" />
            </div>
            <gs-overlay ng-class="{initialized: pitchInsInitialized}" giftstart="giftStart" ng-click="selectionUpdated();"></gs-overlay>
            <div class="receipt-wrap" ng-show="showPayBox" style="margin: 0">
                <div class="receipt ui card ">
                    <div class="receipt-tiles content">
                        <div class="img-wrap image" style="background-image:url('{{giftStart.product_img_url}}')"></div>
                        <div class="info-tiles">
                            <h2 class="num-tiles">{{giftStart.nSelected}} Pieces</h2>
                            <h4 class="cost-tiles">at  ${{getTileCost() / 100 | number : 2}} Each</h4>
                        </div>
                    </div>
                    <div class="receipt-total">
                        <h4 class="purchase-total header">Purchase Total: </h4>
                        <p class="purchase-note meta">Includes our gift concierge service, taxes, shipping, handling, and handmade card.</p>
                    </div>
                    <div class="extra content">
                        <h2 class="total-price aligned center ui"><i class="dollar icon green"></i>{{giftStart.totalSelection / 100 | number : 2}}</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="ui eight wide computer sixteen wide mobile column" ng-hide="showLoginBox||showPayBox||showSignBox||showShareBox" style="padding: initial;" ng-class="{segment: editMode}">
			<div class="ui fluid card" style="min-height:227px;">
				<div class="content">
                <div class="header">
                    {{giftStart.product_title | limitTo: 90}}
					<a ng-href="{{giftStart.product_url}}" rel="nofollow" class="title linkage" target="_blank" ng-click="productLinkClicked();" ng-mouseover="hideOverlay();" ng-mouseleave="showOverlay();" ng-show="giftStart.product_title" data-content="Visit the product's website">
                        <i class="external share icon"></i>
                    </a>
                </div>
            </div>
            	<div class="content">
                <div class="ui form">
                    <div class="description">
                        <span class="description edit"><textarea class="description" ng-model="newDescription" ng-show="editMode"></textarea></span>
                        <span class="description makelinks" ng-hide="editMode" style="white-space: pre-line;">{{giftStart.description}}</span>
                    </div>
                    <div class="meta ui left icon fluid huge input vertical top small">
                        <p class="name" ng-show="!editMode">
                            <span class="signature__title" ng-show=" giftStart.gc_name "> {{ giftStart.gc_name }} </span>
                        </p>
                        <input class="ui form input" ng-model="newGcName" ng-show="editMode" />
                        <i class="user icon" ng-show="editMode"></i>
                    </div>

                </div>
            </div>
				<div class="extra content" ng-hide="showLoginBox||showPayBox||showSignBox||showShareBox||secondsLeft <= 0||campaignComplete()">
            		<div class="pitch-instructions" ng-show="secondsLeft > 0 && !campaignComplete()">
                <button class="ui pitch-in button huge icon fluid" ng-show="secondsLeft > 0 && !campaignComplete()" ng-class="{disabled: giftStart.totalSelection == 0, teal: giftStart.totalSelection > 0}" ng-click="pitchIn()" ng-mouseover="pitchInHoverCallback()" title="{{pitchinButtonHoverMessage}}">
                    <i class="gift right icon"></i> Pitch In <span class="hidden">${{giftStart.totalSelection / 100 | number : 2}}</span>
                </button>
                <button class="ui invite-friends button blue large fluid icon">
                    <span ng-hide="secondsLeft <= 0 || campaignComplete()">
						<i class="users right icon"></i>
						Invite Friends
					</span>
                    <span ng-show="secondsLeft <= 0 || campaignComplete()">
						<i class="external right share icon"></i>
						Share This Campaign
					</span>
                </button>
                <div class="ui divided selection list">
					<a class="item">
  						<div class="ui red horizontal label">Tip</div>
  						Click the pieces you want to buy then pitch in.
					</a>
                </div>
				<!--div class="invite block">
                <h3 class="black invite-friends">Share This Campaign With Friends!</h3>
                <img class="share" src="/assets/envelope.png" ng-click="emailShare();" />
                <img class="share" src="/assets/facebookicon.png" ng-click="facebookShare();"/>
                <img class="share" src="/assets/twittericon.png" ng-click="twitterShare();" />
                <img class="share" src="/assets/googleicon.png" ng-click="googlePlusShare();" /><br/>
                Or share this link:
                <input id="share-url" type="text" value="{{campaignUrl()}}" gs-copy-url readonly/>
            </div-->
            </div>
        		</div>
				<div class="giftstart-this ui bottom attached warning message" ng-show="secondsLeft <= 0 || campaignComplete()" style="margin-bottom:0">
                    <h3 class="ui header aligned left">
						This campaign has ended, but you can still give it to someone you know.
						Click the button below to start your own campaign.
                    </h3>
                    <a class="giftstart-this-link large teal ui button icon fluid vertical top small" target="_self" href="{{giftstartThisUrl()}}">
						<i class="gift left icon" class="computer only ui"></i>
						GiftStart It
                    </a>
                    <div class="saveforlater hidden">
                        <button class="ui pitch-in button ico large" ng-click="saveProdForLater();">
                            <i class="bookmark icon"></i> Save For Later
                            <img ng-show="isSavingForLater" class="loader" src="/assets/loading_transparent.gif">
                        </button>
                        <div class="product-message" ng-bind-html="productMessage"></div>
                    </div>
                </div>

            	<a class="ui bottom attached button icon" ng-show="campaignEditable && !editMode && secondsLeft > 0 && !campaignComplete()" ng-click="editMode=true;">
                <i class="edit icon"></i> Edit
            </a>
            	<a class="save ui bottom attached button icon" ng-click="updateCampaign();" ng-show="editMode">
                <i class="save icon"></i>Save
            </a>
 			</div>       
		
        </div>
        <div class="login-box ui aligned centered center grid eight wide computer sixteen wide mobile column" ng-show="showLoginBox">
            <a class="label basic ui icon aligned center middle" ng-click="switchLoginBox(false)">
                <i class="cancel icon"></i> Cancel - take me back
            </a>
            <ng-include src="'/scripts/login/login-or-create.html'"></ng-include>
        </div>
        <div class="pay-box ui eight wide computer sixteen wide mobile column" ng-show="showPayBox">
            <p>Your payments are securely processed by PayPal.</p>
            <ng-include src="'/scripts/pay/pay.html'"></ng-include>
        </div>
        <div class="sign-box ui segment piled eight wide computer sixteen wide mobile column" ng-show="showSignBox" style="    margin-top: 0;">
			<a class="ui right ribbon label" ng-click="switchSignBox(false)">Go Back</a>
            <h2>Sign the Card:</h2>
            <p>Write a message to the recipient and we'll include it on the group card so they'll know part of this gift came from you - giving credit where credit is due.</p>
            <ng-include src="'/scripts/popover/note/note-popover.html'"></ng-include>
        </div>
        <div class="share-box" ng-show="showShareBox">
            <h2>Share with Friends:</h2>
            <p>Your payment was successful! Thank you. You will receive an email shorty. In the meantime, you can invite friends to pitch in just like you did.</p>
            <button class="ui invite-friends button blue large fluid icon">
                <i class="users right icon"></i>
                Invite Friends
            </button>
            <a href="" class="linky" ng-click="shareBox(false)">Skip this step</a>
        </div>
        <!--ng-include src="'/scripts/share/invite-pitchin.html'"></ng-include-->
    </div>
    

	<div class="ui container vertical top large stripe quote segment">
            <div class="ui equal width stackable internally celled grid">
                <div class="center aligned row ui grid stackable">
                    <div class="prices block column ui">
                        <gs-funding-bar></gs-funding-bar>
                        <div class="price funded column">
                            <h2><span class="giftstart product contribution">{{giftStart.nBought}}</span> Pieces</h2>
                            <h4>Gifted</h4>
                        </div>
                        <div class="price column ui">
                            <h2><span class="giftstart product remaining">{{giftStart.nTotal-giftStart.nBought}}</span> Pieces</h2>
                            <h4>Remaining</h4>
                        </div>
                    </div>
                    <div class="price block column ui">
                        <p>This campaign <span ng-hide="secondsLeft <= 0 || campaignComplete()">ends</span><span ng-show="secondsLeft <= 0 || campaignComplete()">ended</span> {{giftStart.deadline*1000 | date:"MMMM d 'at' ha PST" : 'PST'}}</p>
                        <div>
                            <h2 class="countdown" ng-class="{danger: (secondsLeft < 86400) && (secondsLeft <= 0)}">{{countdown}}</h2>
                            <h4 ng-hide="secondsLeft <= 0 || campaignComplete()">Left for Pitch-ins</h4>

                        </div>
                    </div>
                </div>

                <div id="share-panel">
                    <a id="closebtn" href="" ng-show="showShare" ng-click="showSharePanel(false)">Close</a>
                    <ng-include src="'/scripts/share/invite-pitchin.html'" ng-show="showShare"></ng-include>
                </div>


                <gs-thanks></gs-thanks>
                <div class="ui container groupcard" ng-show="pitchIns.length > 0">
                    <div class="title vertical bottom medium">
                        <h2 class="title__name">Group Card</h2>
                        <span class="title__catchline">To sign the card, first pitch-in by purchasing some pieces above</span>
                    </div>
                    <div class="ui three stackable cards">
                        <div ng-repeat="pitchIn in pitchIns | orderBy:'-timestamp' track by $index" class="ui card {{randomColor($index)}}">
                            <div class="contributors ui content {{randomColor($index)}}">
                                <div class="block {{randomColor($index)}}"></div>
                                <div class="contributors__figure">
                                    <a class="contributors__link" ng-href="/users/{{pitchIn.uid}}" ng-hide="isEditing(pitchIn) && picEdit">
                                        <img class="contributors__img" ng-src="{{pitchIn.img}}" />
                                    </a>
                                    <a class="userprofile__imageedit button" ng-show="isEditing(pitchIn) && !picEdit" ng-click="setPicEdit(true)">Change photo</a>
                                    <gs-image-upload ng-show="isEditing(pitchIn) && picEdit" on-image-updated="imageUpdated"></gs-image-upload>
                                    <a class="userprofile__imagesave button" ng-click="picSubmit()" ng-show="isEditing(pitchIn) && picEdit">Save</a>
                                </div>
                                <div class="ui form segment inverted {{randomColor($index)}}">
                                    <h4 class="" ng-show="!isEditing(pitchIn)">{{pitchIn.name}}</h4>
                                    <div class="ui field" ng-show="isEditing(pitchIn)">
                                        <input type="text" ng-model="pitchIn.name" placeholder="Name" />
                                    </div>
                                    <p class="content break" ng-show="!isEditing(pitchIn)">{{pitchIn.note}}</p>
                                    <textarea ng-model="pitchIn.note" ng-show="isEditing(pitchIn)" placeholder="Comment" />
                                </div>
                                <div class="ui field" ng-show="isEditing(pitchIn)">
                                    <p id="textcount">{{230 - pitchIn.note.length}} characters</p>
                                </div>

                                <a class="ui top bottom attached button inverted" ng-show="pitchIn.uid == userId && !isEditing(pitchIn) && commentEditing.length == 0" ng-click="editingComment(pitchIn, true)">
                                    <i class="edit icon"></i>
                                    Edit this card
                                </a>
                                <div class="extra content" ng-show="isEditing(pitchIn)">
                                    <div class="ui two buttons tiny">
                                        <div class="ui button tiny" ng-disabled="picUploading || pitchIn.note.length > 230 || pitchIn.name.length > 38 || pitchIn.name.length < 1" ng-click="editingComment(pitchIn, false)">Save</div>
                                        <div class="ui secondary button tiny" ng-click="cancelEditComment(pitchIn)">Dismiss</div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="ui floating message container yellow" ng-hide="pitchIns.length > 0" style="    width: 50%;">No contributors yet - time for <em>you</em> to be the trend setter.</div>

                </div>
                <div ng-show="secondsLeft <= 0 || campaignComplete()" class="ui container grid aligned center centered vertical top large">
                    <a href="#" ng-click="toPDFPage()" class="ui button icon labeled right large">
                        <i class="file icon red right"></i> View The Card
                    </a>
                </div>
            </div>
        </div>
</div>